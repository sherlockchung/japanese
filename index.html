<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An-Yu's JLPT çµ‚æ¥µé™·é˜±ç‰¹è¨“ (æ¼¢å­—è®€éŸ³å¼·åŒ–)</title>
    <style>
        :root {
            --primary: #6366f1; /* Indigo 500 */
            --primary-hover: #4f46e5;
            --success: #10b981;
            --error: #ef4444;
            --bg: #f8fafc;
            --card: #ffffff;
            --text-main: #1e293b;
        }

        body {
            font-family: 'Hiragino Sans', 'Meiryo', 'Microsoft JhengHei', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 15px;
        }

        .container {
            background-color: var(--card);
            width: 100%;
            max-width: 700px;
            border-radius: 24px;
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.1);
            padding: 35px;
            position: relative;
        }

        h1 {
            color: var(--primary);
            font-size: 1.8rem;
            margin: 0 0 10px 0;
            text-align: center;
            letter-spacing: 1px;
        }
        
        .subtitle {
            text-align: center;
            color: #64748b;
            font-size: 0.9rem;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        /* ç‹€æ…‹æ¢ */
        .stats-row {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: #64748b;
            margin-bottom: 8px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .progress-track {
            width: 100%;
            height: 10px;
            background: #e2e8f0;
            border-radius: 99px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), #818cf8);
            width: 0%;
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* é¡Œç›®å¡ç‰‡ */
        .quiz-card {
            background: #f1f5f9;
            border: 2px solid #e2e8f0;
            border-radius: 20px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.02);
        }

        .tag {
            background: var(--primary);
            color: white;
            padding: 6px 16px;
            border-radius: 99px;
            font-size: 0.8rem;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 15px;
            box-shadow: 0 4px 6px -1px rgba(99, 102, 241, 0.4);
        }

        .word-text {
            font-size: 2.8rem;
            font-weight: 800;
            color: #1e293b;
            margin: 10px 0;
        }

        /* é¸é …æŒ‰éˆ• */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        @media (max-width: 500px) {
            .options-grid { grid-template-columns: 1fr; }
            .word-text { font-size: 2.2rem; }
            .container { padding: 20px; }
        }

        button.opt-btn {
            background: white;
            border: 2px solid #cbd5e1;
            color: var(--text-main);
            padding: 18px;
            border-radius: 14px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 65px;
            position: relative;
            overflow: hidden;
        }

        button.opt-btn:hover:not(:disabled) {
            border-color: var(--primary);
            background: #eef2ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.15);
        }

        button.opt-btn:active:not(:disabled) {
            transform: translateY(0);
        }

        button.opt-btn.correct {
            background: var(--success);
            color: white;
            border-color: var(--success);
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.4);
        }

        button.opt-btn.wrong {
            background: var(--error);
            color: white;
            border-color: var(--error);
            opacity: 0.9;
        }

        .feedback-area {
            min-height: 30px;
            margin-top: 20px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            border: none;
            padding: 16px 45px;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
        }
        .btn-primary:hover { 
            background: var(--primary-hover);
            transform: translateY(-2px);
        }

        .hidden { display: none !important; }
    </style>
</head>
<body>

<div class="container">
    <div id="start-screen">
        <h1>JLPT çµ‚æ¥µé™·é˜±ç‰¹è¨“</h1>
        <div class="subtitle">
            ç‰¹åˆ¥å¼·åŒ–ï¼šæ¼¢å­—è®€éŸ³é™·é˜± (Traps)<br>
            ä¾‹ï¼š<span style="color:#ef4444; font-weight:bold;">ç™ºã¤</span> (æ­£è§£: ãŸã¤ / é™·é˜±: ã¯ã¤)
        </div>
        <div style="margin: 30px 0; color: #475569; font-size: 0.95rem; background: #f1f5f9; padding: 20px; border-radius: 12px; text-align: left;">
            <strong style="color: var(--primary);">æ¸¬é©—èªªæ˜ï¼š</strong>
            <ul style="margin: 10px 0 0 20px; padding: 0;">
                <li style="margin-bottom: 8px;">é¸æ„æ€é¡Œï¼šåªé¡¯ç¤ºå‡å (è½éŸ³è¾¨ç¾©)</li>
                <li style="margin-bottom: 8px;">é¸è®€éŸ³é¡Œï¼šå¹²æ“¾é …åŒ…å«åŒæ¼¢å­—çš„éŒ¯èª¤è®€éŸ³</li>
                <li>éŒ¯é¡Œæœƒè‡ªå‹•é‡æ–°æ’å…¥éšŠåˆ—ï¼Œç›´åˆ°ç­”å°</li>
            </ul>
        </div>
        <button class="btn-primary" onclick="startQuiz()">é–‹å§‹æŒ‘æˆ°</button>
    </div>

    <div id="quiz-screen" class="hidden">
        <div class="stats-row">
            <span id="progress-text">Progress: 0 / 20</span>
            <span id="queue-text">Queue: 20</span>
        </div>
        <div class="progress-track">
            <div class="progress-fill" id="progress-fill"></div>
        </div>

        <div class="quiz-card">
            <div class="tag" id="q-type-badge"></div>
            <div class="word-text" id="q-word"></div>
        </div>

        <div class="options-grid" id="options-container"></div>
        <div class="feedback-area" id="feedback-msg"></div>
    </div>

    <div id="result-screen" class="hidden" style="text-align: center;">
        <div style="font-size: 4rem; margin-bottom: 10px;">ğŸ†</div>
        <h1 style="color: var(--text-main); font-size: 2rem;">ç‰¹è¨“é”æˆï¼</h1>
        <p style="font-size: 1.1rem; color: #64748b; margin-bottom: 30px;">
            æ‚¨å·²ç¶“æˆåŠŸé¿é–‹äº†æ‰€æœ‰çš„è®€éŸ³é™·é˜±ã€‚
        </p>
        <div id="result-stats" style="margin-bottom: 30px; font-weight: bold; color: var(--primary); font-size: 1.2rem;"></div>
        <button class="btn-primary" onclick="location.reload()">å†æ¬¡æŒ‘æˆ°</button>
    </div>
</div>

<script>
    // ==========================================
    // è³‡æ–™åº«ï¼šåŒ…å«æ‰‹å‹•æ¨™è¨»çš„é™·é˜± (Traps)
    // ==========================================
    const rawData = [
        // --- ç‰¹æ®Šé™·é˜±å¼·åŒ–å€ (åŸºæ–¼æ‚¨çš„è¦æ±‚) ---
        {kanji: "ç™ºã¤", kana: "ãŸã¤", meaning: "å‡ºç™¼", traps: ["ã¯ã¤", "ã»ã¤", "ã¯ã£ã¤"]},
        {kanji: "ç€ã", kana: "ã¤ã", meaning: "æŠµé”", traps: ["ã¡ã‚ƒã", "ãã", "ã˜ã‚…ã"]},
        {kanji: "é€šã†", kana: "ã‹ã‚ˆã†", meaning: "å¾€ä¾†/é€šå‹¤", traps: ["ã¨ãŠã‚‹", "ã¤ã†ã‚ˆã†"]}, 
        {kanji: "é€šã‚‹", kana: "ã¨ãŠã‚‹", meaning: "é€šé", traps: ["ã‹ã‚ˆã†", "ã¤ã†ã‚‹"]},
        {kanji: "åº§å¸­", kana: "ã–ã›ã", meaning: "åº§ä½", traps: ["ã™ã‚ã£ã¦", "ã–ã—ã‚‡ã"]},
        {kanji: "å¾€å¾©", kana: "ãŠã†ãµã", meaning: "å¾€è¿”", traps: ["ã‚†ãã‹ãˆã‚Š", "ã”ã†ãµã"]},
        {kanji: "ç‰‡é“", kana: "ã‹ãŸã¿ã¡", meaning: "å–®ç¨‹", traps: ["ã¸ã‚“ã©ã†", "ã‹ãŸã˜"]},
        {kanji: "å®¿æ³Š", kana: "ã—ã‚…ãã¯ã", meaning: "ä½å®¿", traps: ["ã¨ã¾ã‚Š", "ã—ã‚…ãã±ã"]},
        {kanji: "æ»åœ¨", kana: "ãŸã„ã–ã„", meaning: "åœç•™", traps: ["ã¦ã„ãŸã„", "ãŸã„ã„"]},
        {kanji: "æ··é›‘", kana: "ã“ã‚“ã–ã¤", meaning: "æ“æ“ ", traps: ["ã¾ãœã¾ãœ", "ã“ã‚“ãã†"]},
        {kanji: "çµŒç”±", kana: "ã‘ã„ã‚†", meaning: "ç¶“ç”±", traps: ["ãã‚‡ã†ã‚†", "ã¸ã‚†"]}, 
        {kanji: "ä¹—è»Š", kana: "ã˜ã‚‡ã†ã—ã‚ƒ", meaning: "ä¹˜è»Š", traps: ["ã®ã‚Šãã‚‹ã¾", "ã˜ã‚‡ã†ãã‚‹ã¾"]},
        {kanji: "ä¸‹è»Š", kana: "ã’ã—ã‚ƒ", meaning: "ä¸‹è»Š", traps: ["ã‹ã—ã‚ƒ", "ã—ãŸãã‚‹ã¾"]},
        {kanji: "ä¹—å®¢", kana: "ã˜ã‚‡ã†ãã‚ƒã", meaning: "ä¹˜å®¢", traps: ["ã®ã‚Šãã‚ƒã", "ã˜ã‚‡ã†ã‹ã"]},
        {kanji: "ä½œæˆ", kana: "ã•ãã›ã„", meaning: "è£½ä½œ", traps: ["ã•ããªã‚Š", "ã•ã—ã‚‡ã†"]},
        {kanji: "å‰Šé™¤", kana: "ã•ãã˜ã‚‡", meaning: "åˆªé™¤", traps: ["ã‘ã—ã˜ã‚‡", "ã•ãã˜ã‚…"]},
        {kanji: "å…¥åŠ›", kana: "ã«ã‚…ã†ã‚Šã‚‡ã", meaning: "è¼¸å…¥", traps: ["ã„ã‚Œã‚Šã‚‡ã", "ã˜ã‚…ã‚Šã‚‡ã"]}, 
        {kanji: "ä¸­å¤", kana: "ã¡ã‚…ã†ã“", meaning: "äºŒæ‰‹", traps: ["ãªã‹ãµã‚‹", "ã¡ã‚…ã†ãµã‚‹"]},
        {kanji: "æ“ä½œ", kana: "ãã†ã•", meaning: "æ“ä½œ", traps: ["ã¿ã•ãŠ", "ãã†ã•ã"]},
        {kanji: "ä¿®ç†", kana: "ã—ã‚…ã†ã‚Š", meaning: "ä¿®ç†", traps: ["ãªãŠã‚Š", "ãŠã•ã¾ã‚Š"]},
        {kanji: "ç”Ÿç‰©å­¦", kana: "ã›ã„ã¶ã¤ãŒã", meaning: "ç”Ÿç‰©å­¸", traps: ["ãªã¾ã‚‚ã®ãŒã", "ã„ãã‚‚ã®ãŒã"]},
        {kanji: "ç‰©ç†", kana: "ã¶ã¤ã‚Š", meaning: "ç‰©ç†", traps: ["ã‚‚ã®ã‚Š", "ã¶ã¤ã‚Šã‚ƒã"]},
        {kanji: "åŒ–å­¦", kana: "ã‹ãŒã", meaning: "åŒ–å­¸", traps: ["ã°ã‘ãŒã", "ã‹ã¿"]}, 
        {kanji: "å°‚æ”»", kana: "ã›ã‚“ã“ã†", meaning: "å°ˆæ”»", traps: ["ã‚‚ã£ã±ã‚‰", "ã›ã‚“ã“"]},
        {kanji: "å®Ÿé¨“", kana: "ã˜ã£ã‘ã‚“", meaning: "å¯¦é©—", traps: ["ã˜ã¤ã‘ã‚“", "ã¿é¨“"]},
        {kanji: "å­¦ä¼š", kana: "ãŒã£ã‹ã„", meaning: "å­¸æœƒ", traps: ["ã¾ãªã¶ã‹ã„", "ãŒãã‹ã„"]},
        {kanji: "å°±è·", kana: "ã—ã‚…ã†ã—ã‚‡ã", meaning: "å°±è·", traps: ["ã¤ãã—ã‚‡ã", "ã—ã‚…ã†ã—ã"]},
        {kanji: "æœˆçµ¦", kana: "ã’ã£ãã‚…ã†", meaning: "æœˆè–ª", traps: ["ãŒã£ãã‚…ã†", "ã¤ããã‚…ã†"]},
        {kanji: "é‡å½¹", kana: "ã˜ã‚…ã†ã‚„ã", meaning: "é‡è‡£/è‘£äº‹", traps: ["ãŠã‚‚ã‚„ã", "ã¡ã‚‡ã†ã‚„ã"]},
        {kanji: "åŠ´åƒ", kana: "ã‚ã†ã©ã†", meaning: "å‹å‹•", traps: ["ã¯ãŸã‚‰ã", "ã‚ã†ã†ã”"]},
        {kanji: "æœåˆŠ", kana: "ã¡ã‚‡ã†ã‹ã‚“", meaning: "æ—©å ±", traps: ["ã‚ã•ã‹ã‚“", "ã¡ã‚‡ã†ã‘ã‚“"]},
        {kanji: "å¤•åˆŠ", kana: "ã‚†ã†ã‹ã‚“", meaning: "æ™šå ±", traps: ["ã›ãã‹ã‚“", "ã‚†ã†ã‘ã‚“"]},
        {kanji: "ç•ªçµ„", kana: "ã°ã‚“ãã¿", meaning: "ç¯€ç›®", traps: ["ã°ã‚“ãã¿", "ã°ã‚“ã"]},
        {kanji: "æœ€ä¸­", kana: "ã•ã„ã¡ã‚…ã†", meaning: "æ­£åœ¨...ä¸­", traps: ["ã‚‚ãªã‹", "ã•ã„ãªã‹"]}, 
        {kanji: "é¢¨é‚ª", kana: "ã‹ãœ", meaning: "æ„Ÿå†’", traps: ["ãµã†ã˜ã‚ƒ", "ã‹ã–"]}, 
        {kanji: "ç­”æ¡ˆ", kana: "ã¨ã†ã‚ã‚“", meaning: "ç­”æ¡ˆå·", traps: ["ã“ãŸãˆã‚ã‚“", "ã©ã†ã‚ã‚“"]}, 

        // --- å…¶ä»–å–®å­— (ç³»çµ±æœƒè‡ªå‹•ç”ŸæˆéŸ³è¿‘å¹²æ“¾) ---
        {kanji: "æ¯›ç³¸", kana: "ã‘ã„ã¨", meaning: "æ¯›ç·š"},
        {kanji: "ç·¨ã‚€", kana: "ã‚ã‚€", meaning: "ç·¨ç¹”"},
        {kanji: "æ•£ã‚‰ã‹ã‚‹", kana: "ã¡ã‚‰ã‹ã‚‹", meaning: "æ•£äº‚"},
        {kanji: "é€€ã‘ã‚‹", kana: "ã©ã‘ã‚‹", meaning: "ç§»é–‹"},
        {kanji: "åŸƒ", kana: "ã»ã“ã‚Š", meaning: "ç°å¡µ"},
        {kanji: "ç®’", kana: "ã»ã†ã", meaning: "æƒæŠŠ"},
        {kanji: "å¡µå–ã‚Š", kana: "ã¡ã‚Šã¨ã‚Š", meaning: "ç•šç®•"},
        {kanji: "å¹²ã™", kana: "ã»ã™", meaning: "æ›¬"},
        {kanji: "ä¹¾ã‹ã™", kana: "ã‹ã‚ã‹ã™", meaning: "å¼„ä¹¾"},
        {kanji: "åŠã‚‹ã™", kana: "ã¤ã‚‹ã™", meaning: "åŠæ›"},
        {kanji: "èŒ¹ã§ã‚‹", kana: "ã‚†ã§ã‚‹", meaning: "ç‡™/ç…®"},
        {kanji: "ç‚’ã‚ã‚‹", kana: "ã„ãŸã‚ã‚‹", meaning: "ç‚’"},
        {kanji: "ç‚Šã", kana: "ãŸã", meaning: "ç…®(é£¯)"},
        {kanji: "ç…®ã‚‹", kana: "ã«ã‚‹", meaning: "ç…®"},
        {kanji: "å‡ºæ¥ä¸ŠãŒã‚‹", kana: "ã§ãã‚ãŒã‚‹", meaning: "å®Œæˆ"},
        {kanji: "è£è¿”ã™", kana: "ã†ã‚‰ãŒãˆã™", meaning: "ç¿»é¢"},
        {kanji: "ç•³ã‚€", kana: "ãŸãŸã‚€", meaning: "æ‘ºç–Š"},
        {kanji: "ç‚Šäº‹", kana: "ã™ã„ã˜", meaning: "çƒ¹é£ªäº‹å‹™"},
        {kanji: "çŒ®ç«‹", kana: "ã“ã‚“ã ã¦", meaning: "èœå–®"},
        {kanji: "åã", kana: "ã¯ã", meaning: "å˜”å"},
        {kanji: "é½§ã‚‹", kana: "ã‹ã˜ã‚‹", meaning: "å’¬/å•ƒ"},
        {kanji: "é…”ã†", kana: "ã‚ˆã†", meaning: "å–é†‰"},
        {kanji: "ç›®çœ©", kana: "ã‚ã¾ã„", meaning: "æšˆçœ©"},
        {kanji: "å¥¢ã‚‹", kana: "ãŠã”ã‚‹", meaning: "è«‹å®¢"},
        {kanji: "æ•¬æ„", kana: "ã‘ã„ã„", meaning: "æ•¬æ„"},
        {kanji: "è¶³é¦–", kana: "ã‚ã—ãã³", meaning: "è…³è¸"},
        {kanji: "æ»ã‚‹", kana: "ã²ã­ã‚‹", meaning: "æ‰­è½‰"},
        {kanji: "è¡€æ¶²", kana: "ã‘ã¤ãˆã", meaning: "è¡€æ¶²"},
        {kanji: "æ±šæŸ“", kana: "ãŠã›ã‚“", meaning: "æ±™æŸ“"},
        {kanji: "å†…ç§‘", kana: "ãªã„ã‹", meaning: "å…§ç§‘"},
        {kanji: "å¤–ç§‘", kana: "ã’ã‹", meaning: "å¤–ç§‘"},
        {kanji: "éª¨æŠ˜", kana: "ã“ã£ã›ã¤", meaning: "éª¨æŠ˜"},
        {kanji: "ç™½é«ª", kana: "ã—ã‚‰ãŒ", meaning: "ç™½é ­é«®"},
        {kanji: "åŒ…å¸¯", kana: "ã»ã†ãŸã„", meaning: "ç¹ƒå¸¶"},
        {kanji: "è–¬å±€", kana: "ã‚„ã£ãã‚‡ã", meaning: "è—¥å±€"},
        {kanji: "è¨ºå¯Ÿ", kana: "ã—ã‚“ã•ã¤", meaning: "è¨ºå¯Ÿ"},
        {kanji: "è¨ºæ–­", kana: "ã—ã‚“ã ã‚“", meaning: "è¨ºæ–·"},
        {kanji: "äºˆé˜²", kana: "ã‚ˆã¼ã†", meaning: "é é˜²"},
        {kanji: "ç¡çœ ", kana: "ã™ã„ã¿ã‚“", meaning: "ç¡çœ "},
        {kanji: "å¯¿å‘½", kana: "ã˜ã‚…ã¿ã‚‡ã†", meaning: "å£½å‘½"},
        {kanji: "é«­", kana: "ã²ã’", meaning: "é¬å­"},
        {kanji: "å‰ƒã‚‹", kana: "ãã‚‹", meaning: "å‰ƒ"},
        {kanji: "æ«›", kana: "ãã—", meaning: "æ¢³å­"},
        {kanji: "æ¢³ã‹ã™", kana: "ã¨ã‹ã™", meaning: "æ¢³ç†"},
        {kanji: "ç›¸æ£’", kana: "ã‚ã„ã¼ã†", meaning: "å¤¥ä¼´"},
        {kanji: "æ´¾æ‰‹", kana: "ã¯ã§", meaning: "èŠ±ä¿"},
        {kanji: "åœ°å‘³", kana: "ã˜ã¿", meaning: "æ¨¸ç´ "},
        {kanji: "å‘æ€¯", kana: "ã²ãã‚‡ã†", meaning: "å‘é„™"},
        {kanji: "å¨å¼µã‚‹", kana: "ã„ã°ã‚‹", meaning: "å‚²æ…¢"},
        {kanji: "æˆ‘å„˜", kana: "ã‚ãŒã¾ã¾", meaning: "ä»»æ€§"},
        {kanji: "æ…é‡", kana: "ã—ã‚“ã¡ã‚‡ã†", meaning: "æ…é‡"},
        {kanji: "è¦é ˜", kana: "ã‚ˆã†ã‚Šã‚‡ã†", meaning: "è¦é ˜"},
        {kanji: "è¬™è™š", kana: "ã‘ã‚“ãã‚‡", meaning: "è¬™è™›"},
        {kanji: "ç”Ÿæ„æ°—", kana: "ãªã¾ã„ã", meaning: "è‡ªå¤§"},
        {kanji: "åšã‹ã¾ã—ã„", kana: "ã‚ã¤ã‹ã¾ã—ã„", meaning: "åšè‡‰çš®"},
        {kanji: "å¹³æ°—", kana: "ã¸ã„ã", meaning: "ä¸åœ¨ä¹"},
        {kanji: "è£åˆ‡ã‚‹", kana: "ã†ã‚‰ãã‚‹", meaning: "èƒŒå›"},
        {kanji: "æ…Œã¦ã‚‹", kana: "ã‚ã‚ã¦ã‚‹", meaning: "æ…Œå¼µ"},
        {kanji: "æ¸…æ½”", kana: "ã›ã„ã‘ã¤", meaning: "æ¸…æ½”"},
        {kanji: "è¦‹æ›ã‘", kana: "ã¿ã‹ã‘", meaning: "å¤–è¡¨"},
        {kanji: "èª¤è§£", kana: "ã”ã‹ã„", meaning: "èª¤æœƒ"},
        {kanji: "é“å¾³", kana: "ã©ã†ã¨ã", meaning: "é“å¾·"},
        {kanji: "ä½™è¨ˆ", kana: "ã‚ˆã‘ã„", meaning: "å¤šé¤˜"},
        {kanji: "å¤§ã—ãŸ", kana: "ãŸã„ã—ãŸ", meaning: "äº†ä¸èµ·çš„"},
        {kanji: "ç ´ç‰‡", kana: "ã¯ã¸ã‚“", meaning: "ç¢ç‰‡"},
        {kanji: "åˆ‡ã£æ›ã‘", kana: "ãã£ã‹ã‘", meaning: "å¥‘æ©Ÿ"},
        {kanji: "å¥‘æ©Ÿ", kana: "ã‘ã„ã", meaning: "å¥‘æ©Ÿ"},
        {kanji: "å¸¸ã«", kana: "ã¤ã­ã«", meaning: "ç¸½æ˜¯"},
        {kanji: "æ¯”è¼ƒ", kana: "ã²ã‹ã", meaning: "æ¯”è¼ƒ"},
        {kanji: "åºã«", kana: "ã¤ã„ã§ã«", meaning: "é †ä¾¿"},
        {kanji: "æ¬¡ç¬¬ã«", kana: "ã—ã ã„ã«", meaning: "é€æ¼¸"},
        {kanji: "å¿…æ­»ã«", kana: "ã²ã£ã—ã«", meaning: "æ‹¼å‘½åœ°"},
        {kanji: "æ¡ˆå¤–", kana: "ã‚ã‚“ãŒã„", meaning: "æ„å¤–åœ°"},
        {kanji: "è‡ªã‚‰", kana: "ã¿ãšã‹ã‚‰", meaning: "è¦ªè‡ª"},
        {kanji: "ä¸€ç¬", kana: "ã„ã£ã—ã‚…ã‚“", meaning: "ä¸€ç¬é–“"},
        {kanji: "è‹¥å¹²", kana: "ã˜ã‚ƒã£ã‹ã‚“", meaning: "è‹¥å¹²"},
        {kanji: "æ¬ å“", kana: "ã‘ã£ã´ã‚“", meaning: "ç¼ºè²¨"},
        {kanji: "æ—©é€Ÿ", kana: "ã•ã£ãã", meaning: "ç«‹åˆ»"},
        {kanji: "ä½™ç¨‹", kana: "ã‚ˆã»ã©", meaning: "ç›¸ç•¶"},
        {kanji: "ä¸‡ãŒä¸€", kana: "ã¾ã‚“ãŒã„ã¡", meaning: "è¬ä¸€"},
        {kanji: "å½“åˆ†", kana: "ã¨ã†ã¶ã‚“", meaning: "æš«æ™‚"},
        {kanji: "è¦‹è¾¼ã¿", kana: "ã¿ã“ã¿", meaning: "é ä¼°"},
        {kanji: "å®Ÿã«", kana: "ã˜ã¤ã«", meaning: "å¯¦åœ¨æ˜¯"},
        {kanji: "ä¸€å¿œ", kana: "ã„ã¡ãŠã†", meaning: "å§‘ä¸”"},
        {kanji: "å›£ä½“", kana: "ã ã‚“ãŸã„", meaning: "åœ˜é«”"},
        {kanji: "å€‹äºº", kana: "ã“ã˜ã‚“", meaning: "å€‹äºº"},
        {kanji: "æ—¥å¸°ã‚Š", kana: "ã²ãŒãˆã‚Š", meaning: "ç•¶æ—¥ä¾†å›"},
        {kanji: "äºŒæ³Šä¸‰æ—¥", kana: "ã«ã¯ãã¿ã£ã‹", meaning: "ä¸‰å¤©å…©å¤œ"},
        {kanji: "åˆ¥è˜", kana: "ã¹ã£ãã†", meaning: "åˆ¥å¢…"},
        {kanji: "è¦‹é€ã‚‹", kana: "ã¿ãŠãã‚‹", meaning: "é€è¡Œ"},
        {kanji: "å‡ºè¿ãˆã‚‹", kana: "ã§ã‚€ã‹ãˆã‚‹", meaning: "è¿æ¥"},
        {kanji: "é€è¿", kana: "ãã†ã’ã„", meaning: "æ¥é€"},
        {kanji: "åæ‰€", kana: "ã‚ã„ã—ã‚‡", meaning: "åå‹"},
        {kanji: "åœç•™æ‰€", kana: "ã¦ã„ã‚Šã‚…ã†ã˜ã‚‡", meaning: "å…¬è»Šç«™"},
        {kanji: "å£²åº—", kana: "ã°ã„ã¦ã‚“", meaning: "è²©è³£éƒ¨"},
        {kanji: "æ¨ªæ–­", kana: "ãŠã†ã ã‚“", meaning: "æ©«è¶Š"},
        {kanji: "ç¸¦æ–­", kana: "ã˜ã‚…ã†ã ã‚“", meaning: "ç¸±è²«"},
        {kanji: "åˆ°ç€", kana: "ã¨ã†ã¡ã‚ƒã", meaning: "æŠµé”"},
        {kanji: "é£›è¡Œæ©Ÿ", kana: "ã²ã“ã†ã", meaning: "é£›æ©Ÿ"},
        {kanji: "è¡Œæ–¹", kana: "ã‚†ããˆ", meaning: "è¡Œè¹¤"},
        {kanji: "å›æ•°åˆ¸", kana: "ã‹ã„ã™ã†ã‘ã‚“", meaning: "å›æ•¸ç¥¨"},
        {kanji: "å®šå“¡", kana: "ã¦ã„ã„ã‚“", meaning: "å®šå“¡"},
        {kanji: "åˆ—å³¶", kana: "ã‚Œã£ã¨ã†", meaning: "åˆ—å³¶"},
        {kanji: "åŠå³¶", kana: "ã¯ã‚“ã¨ã†", meaning: "åŠå³¶"},
        {kanji: "ç›†åœ°", kana: "ã¼ã‚“ã¡", meaning: "ç›†åœ°"},
        {kanji: "å¹³é‡", kana: "ã¸ã„ã‚„", meaning: "å¹³åŸ"},
        {kanji: "ç ‚æ¼ ", kana: "ã•ã°ã", meaning: "æ²™æ¼ "},
        {kanji: "é¢¨æ™¯", kana: "ãµã†ã‘ã„", meaning: "é¢¨æ™¯"},
        {kanji: "åœ°å¹³ç·š", kana: "ã¡ã¸ã„ã›ã‚“", meaning: "åœ°å¹³ç·š"},
        {kanji: "æ–°å­¦æœŸ", kana: "ã—ã‚“ãŒã£ã", meaning: "æ–°å­¸æœŸ"},
        {kanji: "ä¸Šæ—¬", kana: "ã˜ã‚‡ã†ã˜ã‚…ã‚“", meaning: "ä¸Šæ—¬"},
        {kanji: "ä¸­æ—¬", kana: "ã¡ã‚…ã†ã˜ã‚…ã‚“", meaning: "ä¸­æ—¬"},
        {kanji: "ä¸‹æ—¬", kana: "ã’ã˜ã‚…ã‚“", meaning: "ä¸‹æ—¬"},
        {kanji: "æ¹¿åº¦", kana: "ã—ã¤ã©", meaning: "æ¿•åº¦"},
        {kanji: "æœå®Ÿ", kana: "ã‹ã˜ã¤", meaning: "æœå¯¦"},
        {kanji: "ç¨²", kana: "ã„ã­", meaning: "ç¨»å­"},
        {kanji: "å¥½å¤©", kana: "ã“ã†ã¦ã‚“", meaning: "å¥½å¤©æ°£"},
        {kanji: "å¹é›ª", kana: "ãµã¶ã", meaning: "æš´é¢¨é›ª"},
        {kanji: "å¹¼å…", kana: "ã‚ˆã†ã˜", meaning: "å¹¼å…’"},
        {kanji: "é€²å­¦", kana: "ã—ã‚“ãŒã", meaning: "å‡å­¸"},
        {kanji: "è»¢æ ¡", kana: "ã¦ã‚“ã“ã†", meaning: "è½‰å­¸"},
        {kanji: "åœ¨å­¦ä¸­", kana: "ã–ã„ãŒãã¡ã‚…ã†", meaning: "åœ¨å­¸ä¸­"},
        {kanji: "æ¼”ç¿’", kana: "ãˆã‚“ã—ã‚…ã†", meaning: "æ¼”ç¿’"},
        {kanji: "å˜ä½", kana: "ãŸã‚“ã„", meaning: "å­¸åˆ†"},
        {kanji: "ä¼‘è¬›", kana: "ãã‚…ã†ã“ã†", meaning: "åœèª²"},
        {kanji: "è‡ªç¿’", kana: "ã˜ã—ã‚…ã†", meaning: "è‡ªç¿’"},
        {kanji: "å­¦æœŸ", kana: "ãŒã£ã", meaning: "å­¸æœŸ"},
        {kanji: "æ™‚é–“å‰²", kana: "ã˜ã‹ã‚“ã‚ã‚Š", meaning: "èª²è¡¨"},
        {kanji: "è¬›ç¾©", kana: "ã“ã†ã", meaning: "è¬›ç¾©"},
        {kanji: "å®Ÿç¿’", kana: "ã˜ã£ã—ã‚…ã†", meaning: "å¯¦ç¿’"},
        {kanji: "æ¡ç‚¹", kana: "ã•ã„ã¦ã‚“", meaning: "è©•åˆ†"},
        {kanji: "æœŸæœ«", kana: "ãã¾ã¤", meaning: "æœŸæœ«"},
        {kanji: "ç­†è¨˜", kana: "ã²ã£ã", meaning: "ç­†è©¦"},
        {kanji: "æ•™ç§‘æ›¸", kana: "ãã‚‡ã†ã‹ã—ã‚‡", meaning: "æ•™ç§‘æ›¸"},
        {kanji: "æˆç¸¾", kana: "ã›ã„ã›ã", meaning: "æˆç¸¾"},
        {kanji: "è©•ä¾¡", kana: "ã²ã‚‡ã†ã‹", meaning: "è©•åƒ¹"},
        {kanji: "å­¦å•", kana: "ãŒãã‚‚ã‚“", meaning: "å­¸å•"},
        {kanji: "çµŒæ¸ˆå­¦", kana: "ã‘ã„ã–ã„ãŒã", meaning: "ç¶“æ¿Ÿå­¸"},
        {kanji: "äººæ–‡", kana: "ã˜ã‚“ã¶ã‚“", meaning: "äººæ–‡"},
        {kanji: "å“²å­¦", kana: "ã¦ã¤ãŒã", meaning: "å“²å­¸"},
        {kanji: "ç ”ç©¶", kana: "ã‘ã‚“ãã‚…ã†", meaning: "ç ”ç©¶"},
        {kanji: "å¦¥å½“", kana: "ã ã¨ã†", meaning: "å¦¥ç•¶"},
        {kanji: "è¨¼æ˜", kana: "ã—ã‚‡ã†ã‚ã„", meaning: "è­‰æ˜"},
        {kanji: "ç ”ä¿®", kana: "ã‘ã‚“ã—ã‚…ã†", meaning: "é€²ä¿®"},
        {kanji: "ä¸€æµ", kana: "ã„ã¡ã‚Šã‚…ã†", meaning: "ä¸€æµ"},
        {kanji: "ç†±ä¸­", kana: "ã­ã£ã¡ã‚…ã†", meaning: "ç†±è¡·"},
        {kanji: "ä¼‘æš‡", kana: "ãã‚…ã†ã‹", meaning: "ä¼‘å‡"},
        {kanji: "ç”³è«‹", kana: "ã—ã‚“ã›ã„", meaning: "ç”³è«‹"},
        {kanji: "ææ¡ˆ", kana: "ã¦ã„ã‚ã‚“", meaning: "ææ¡ˆ"},
        {kanji: "èƒ½ç‡", kana: "ã®ã†ã‚Šã¤", meaning: "æ•ˆç‡"},
        {kanji: "å¤±æ¥­", kana: "ã—ã¤ãã‚‡ã†", meaning: "å¤±æ¥­"},
        {kanji: "ç¨¼åƒ", kana: "ã‹ã©ã†", meaning: "é‹è½‰"},
        {kanji: "ç ´ç”£", kana: "ã¯ã•ã‚“", meaning: "ç ´ç”¢"},
        {kanji: "çµŒå–¶", kana: "ã‘ã„ãˆã„", meaning: "ç¶“ç‡Ÿ"},
        {kanji: "è³‡æœ¬é‡‘", kana: "ã—ã»ã‚“ãã‚“", meaning: "è³‡æœ¬é‡‘"},
        {kanji: "å‹Ÿé›†", kana: "ã¼ã—ã‚…ã†", meaning: "å‹Ÿé›†"},
        {kanji: "æŒ‡ç¤º", kana: "ã—ã˜", meaning: "æŒ‡ç¤º"},
        {kanji: "æ‰èƒ½", kana: "ã•ã„ã®ã†", meaning: "æ‰èƒ½"},
        {kanji: "çµ„åˆ", kana: "ãã¿ã‚ã„", meaning: "å·¥æœƒ"},
        {kanji: "æ¡ä»¶", kana: "ã˜ã‚‡ã†ã‘ã‚“", meaning: "æ¢ä»¶"},
        {kanji: "æ”¹å–„", kana: "ã‹ã„ãœã‚“", meaning: "æ”¹å–„"},
        {kanji: "è¦æ±‚", kana: "ã‚ˆã†ãã‚…ã†", meaning: "è¦æ±‚"},
        {kanji: "åˆ©å®³", kana: "ã‚ŠãŒã„", meaning: "åˆ©å®³"},
        {kanji: "åˆ©ç›Š", kana: "ã‚Šãˆã", meaning: "åˆ©ç›Š"},
        {kanji: "å¼è­·å£«", kana: "ã¹ã‚“ã”ã—", meaning: "å¾‹å¸«"},
        {kanji: "é‡‘è", kana: "ãã‚“ã‚†ã†", meaning: "é‡‘è"},
        {kanji: "å°‚é–€è·", kana: "ã›ã‚“ã‚‚ã‚“ã—ã‚‡ã", meaning: "å°ˆè·"},
        {kanji: "å ±é“", kana: "ã»ã†ã©ã†", meaning: "å ±å°"},
        {kanji: "åºƒå‘Š", kana: "ã“ã†ã“ã", meaning: "å»£å‘Š"},
        {kanji: "å–æ", kana: "ã—ã‚…ã–ã„", meaning: "æ¡è¨ª"},
        {kanji: "å…¥æ‰‹", kana: "ã«ã‚…ã†ã—ã‚…", meaning: "å…¥æ‰‹"},
        {kanji: "ç™ºè¡Œ", kana: "ã¯ã£ã“ã†", meaning: "ç™¼è¡Œ"},
        {kanji: "ä¸–é–“", kana: "ã›ã‘ã‚“", meaning: "ä¸–é–“"},
        {kanji: "è©±é¡Œ", kana: "ã‚ã ã„", meaning: "è©±é¡Œ"},
        {kanji: "æ³¨ç›®", kana: "ã¡ã‚…ã†ã‚‚ã", meaning: "æ³¨ç›®"},
        {kanji: "è¦‹å‡ºã—", kana: "ã¿ã ã—", meaning: "æ¨™é¡Œ"},
        {kanji: "å†…å®¹", kana: "ãªã„ã‚ˆã†", meaning: "å…§å®¹"},
        {kanji: "è©³ç´°", kana: "ã—ã‚‡ã†ã•ã„", meaning: "è©³ç´°"},
        {kanji: "æ­£ç¢º", kana: "ã›ã„ã‹ããª", meaning: "æ­£ç¢º"},
        {kanji: "æ”¾é€", kana: "ã»ã†ãã†", meaning: "å»£æ’­"},
        {kanji: "å®£ä¼", kana: "ã›ã‚“ã§ã‚“", meaning: "å®£å‚³"},
        {kanji: "æ˜ åƒ", kana: "ãˆã„ãã†", meaning: "å½±åƒ"},
        {kanji: "éŸ³å£°", kana: "ãŠã‚“ã›ã„", meaning: "è²éŸ³"},
        {kanji: "å¨¯æ¥½", kana: "ã”ã‚‰ã", meaning: "å¨›æ¨‚"},
        {kanji: "è©•åˆ¤", kana: "ã²ã‚‡ã†ã°ã‚“", meaning: "è©•åƒ¹"},
        {kanji: "é­…åŠ›", kana: "ã¿ã‚Šã‚‡ã", meaning: "é­…åŠ›"},
        {kanji: "è¨ªå•", kana: "ã»ã†ã‚‚ã‚“", meaning: "è¨ªå•"},
        {kanji: "å—ä¿¡", kana: "ã˜ã‚…ã—ã‚“", meaning: "æ¥æ”¶"},
        {kanji: "æ·»ä»˜", kana: "ã¦ã‚“ã·", meaning: "é™„åŠ "},
        {kanji: "ç¨®é¡", kana: "ã—ã‚…ã‚‹ã„", meaning: "ç¨®é¡"},
        {kanji: "è¨­å®š", kana: "ã›ã£ã¦ã„", meaning: "è¨­å®š"},
        {kanji: "æŒ¿å…¥", kana: "ãã†ã«ã‚…ã†", meaning: "æ’å…¥"},
        {kanji: "æ‹¡å¤§", kana: "ã‹ãã ã„", meaning: "æ“´å¤§"},
        {kanji: "ç¸®å°", kana: "ã—ã‚…ãã—ã‚‡ã†", meaning: "ç¸®å°"},
        {kanji: "ä¿å­˜", kana: "ã»ãã‚“", meaning: "ä¿å­˜"},
        {kanji: "æ¥ç¶š", kana: "ã›ã¤ãã", meaning: "é€£æ¥"},
        {kanji: "æ¤œç´¢", kana: "ã‘ã‚“ã•ã", meaning: "æª¢ç´¢"},
        {kanji: "å…¬å¼", kana: "ã“ã†ã—ã", meaning: "å…¬å¼"},
        {kanji: "èµ·å‹•", kana: "ãã©ã†", meaning: "å•Ÿå‹•"},
        {kanji: "çµ‚äº†", kana: "ã—ã‚…ã†ã‚Šã‚‡ã†", meaning: "çµæŸ"},
        {kanji: "å…±æœ‰", kana: "ãã‚‡ã†ã‚†ã†", meaning: "å…±äº«"}
    ];

    let quizQueue = [];
    let wrongCount = 0;
    const TARGET_QUESTIONS = 20;

    // ============================================
    // æ™ºæ…§å‹å¹²æ“¾é …ç”Ÿæˆå™¨ (Smart Distractor Generator)
    // ============================================
    function generateSmartDistractors(word) {
        let distractors = new Set();
        const correctKana = word.kana;

        // 1. å„ªå…ˆåŠ å…¥æ‰‹å‹•è¨­å®šçš„é™·é˜± (Traps)
        if (word.traps && word.traps.length > 0) {
            word.traps.forEach(trap => {
                if (trap !== correctKana) distractors.add(trap);
            });
        }

        // 2. å¦‚æœé™·é˜±ä¸å¤  3 å€‹ï¼Œä½¿ç”¨æ¼”ç®—æ³•è£œè¶³
        let attempts = 0;
        while (distractors.size < 3 && attempts < 50) {
            attempts++;
            let fake = correctKana;
            const strategy = Math.floor(Math.random() * 6);

            if (strategy === 0) { // æ¿éŸ³/åŠæ¿éŸ³
                if (fake.includes('ã¨')) fake = fake.replace('ã¨', 'ã©');
                else if (fake.includes('ã©')) fake = fake.replace('ã©', 'ã¨');
                else if (fake.includes('ã‹')) fake = fake.replace('ã‹', 'ãŒ');
                else if (fake.includes('ãŒ')) fake = fake.replace('ãŒ', 'ã‹');
                else if (fake.includes('ãŸ')) fake = fake.replace('ãŸ', 'ã ');
                else if (fake.includes('ã ')) fake = fake.replace('ã ', 'ãŸ');
                else if (fake.includes('ã¯')) fake = fake.replace('ã¯', 'ã±');
            } else if (strategy === 1) { // é•·éŸ³
                if (fake.includes('ã†')) fake = fake.replace('ã†', '');
                else if (fake.match(/[ãŠã“ãã¨ã©ã®ã‚‚ã‚]/)) fake += 'ã†';
                else if (fake.match(/[ãˆã‘ã›ã¦ã­ã‚ã‚Œ]/)) fake += 'ã„';
            } else if (strategy === 2) { // ä¿ƒéŸ³
                if (fake.includes('ã£')) fake = fake.replace('ã£', 'ã¤');
                else if (fake.length > 2 && !fake.includes('ã£')) {
                    const pos = Math.floor(Math.random() * (fake.length - 1)) + 1;
                    fake = fake.slice(0, pos) + 'ã£' + fake.slice(pos);
                }
            } else if (strategy === 3) { // æ¨¡æ“¬è‡ªå‹•è©/ä»–å‹•è©
                if (fake.endsWith('ã‹ã‚‹')) fake = fake.replace('ã‹ã‚‹', 'ã‘ã‚‹');
                else if (fake.endsWith('ã‘ã‚‹')) fake = fake.replace('ã‘ã‚‹', 'ã‹ã‚‹');
                else if (fake.endsWith('ã‚ã‚‹')) fake = fake.replace('ã‚ã‚‹', 'ãˆã‚‹');
                else if (fake.endsWith('ãˆã‚‹')) fake = fake.replace('ãˆã‚‹', 'ã‚ã‚‹');
            } else { // å°¾éŸ³è®ŠåŒ–
                const endings = ['ã„', 'ã‚“', 'ã¤', 'ã†', 'ã'];
                fake = fake.slice(0, -1) + endings[Math.floor(Math.random() * endings.length)];
            }
            if (fake !== correctKana && fake.length >= 1) distractors.add(fake);
        }

        // 3. çœŸçš„é‚„ä¸å¤ ï¼Œéš¨æ©ŸæŠ“ä¸€å€‹åˆ¥çš„å–®å­—
        while (distractors.size < 3) {
            const randomWord = rawData[Math.floor(Math.random() * rawData.length)];
            if (randomWord.kana !== correctKana) distractors.add(randomWord.kana);
        }
        
        return Array.from(distractors);
    }

    function generateMeaningDistractors(correctMeaning) {
        let distractors = new Set();
        while (distractors.size < 3) {
            const randomWord = rawData[Math.floor(Math.random() * rawData.length)];
            if (randomWord.meaning !== correctMeaning) distractors.add(randomWord.meaning);
        }
        return Array.from(distractors);
    }

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // ============================================
    // æ¸¬é©—æµç¨‹æ§åˆ¶
    // ============================================
    function startQuiz() {
        const shuffledWords = shuffle([...rawData]).slice(0, TARGET_QUESTIONS);
        
        const readingQ = shuffledWords.slice(0, 10).map(word => ({
            type: 'READING',
            text: word.kanji,
            correct: word.kana,
            options: shuffle([word.kana, ...generateSmartDistractors(word)]),
            raw: word
        }));

        const meaningQ = shuffledWords.slice(10, 20).map(word => ({
            type: 'MEANING',
            text: word.kana, // è½éŸ³è¾¨ç¾© (é¡¯ç¤ºå‡å)
            correct: word.meaning,
            options: shuffle([word.meaning, ...generateMeaningDistractors(word.meaning)]),
            raw: word
        }));

        quizQueue = shuffle([...readingQ, ...meaningQ]);
        wrongCount = 0;

        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.add('hidden');
        document.getElementById('quiz-screen').classList.remove('hidden');
        renderQuestion();
    }

    function renderQuestion() {
        if (quizQueue.length === 0) {
            showResult();
            return;
        }

        const q = quizQueue[0];
        const remaining = quizQueue.length;
        const progress = TARGET_QUESTIONS - remaining;
        const percentage = Math.min((progress / TARGET_QUESTIONS) * 100, 100);

        document.getElementById('progress-text').innerText = `å·²å®Œæˆ: ${progress} / ${TARGET_QUESTIONS}`;
        document.getElementById('queue-text').innerText = `å‰©é¤˜: ${remaining}`;
        document.getElementById('progress-fill').style.width = `${percentage}%`;

        document.getElementById('q-type-badge').innerText = q.type === 'READING' ? 'é¸å‡ºè®€éŸ³' : 'é¸å‡ºæ„æ€';
        document.getElementById('q-word').innerText = q.text;
        document.getElementById('feedback-msg').innerText = '';

        const container = document.getElementById('options-container');
        container.innerHTML = '';

        q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'opt-btn';
            btn.innerText = opt;
            btn.onclick = () => handleAnswer(btn, opt, q);
            container.appendChild(btn);
        });
    }

    function handleAnswer(btn, selected, q) {
        const allBtns = document.querySelectorAll('.opt-btn');
        allBtns.forEach(b => b.disabled = true);

        if (selected === q.correct) {
            btn.classList.add('correct');
            document.getElementById('feedback-msg').style.color = 'var(--success)';
            document.getElementById('feedback-msg').innerText = 'æ­£è§£ï¼ â­•';
            
            setTimeout(() => {
                quizQueue.shift();
                renderQuestion();
            }, 800);
        } else {
            btn.classList.add('wrong');
            wrongCount++;
            
            allBtns.forEach(b => {
                if (b.innerText === q.correct) b.classList.add('correct');
            });

            document.getElementById('feedback-msg').style.color = 'var(--error)';
            const correctInfo = q.type === 'READING' ? q.raw.meaning : `(${q.raw.kanji})`;
            document.getElementById('feedback-msg').innerText = `éŒ¯èª¤ï¼ ${correctInfo}`;

            // éŒ¯é¡Œæ‡²ç½°ï¼šé‡æ–°æ’å…¥éšŠåˆ—
            const retryQ = quizQueue.shift();
            retryQ.options = shuffle(retryQ.options);
            quizQueue.push(retryQ);

            setTimeout(() => {
                renderQuestion();
            }, 2500);
        }
    }

    function showResult() {
        document.getElementById('quiz-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.remove('hidden');
        document.getElementById('result-stats').innerHTML = 
            `æœ¬æ¬¡æ‰å…¥é™·é˜±æ¬¡æ•¸ï¼š${wrongCount} æ¬¡`;
    }
</script>
</body>
</html>
